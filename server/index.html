<!doctype html>
<html>

  <head>
    <meta content="text/html" charset="utf-8" />

    <title>IDP</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.bundle.js"></script>
  </head>

  <body>
    <h1>IDP - Algenreaktor - Team Blau</h1>

    <canvas id="chart" width="800" height="400"></canvas>

    <script>
      window.onload = function() {
        fetch("/api/values.php?start=2017-12-29+00:00:00&end=2018-01-01+00:00:00").then(function(response) {
          if (!response.ok) {
            throw new Error("Error fetching values!");
          }
          return response.json();
        })
        .then(function (json) {
          var times = json.map(e => e.time);
          var temperatures = json.map(e => e.temp);
          var ph = json.map(e => e.ph);

          var ctx = document.getElementById("chart").getContext("2d");
          var chart = new Chart(ctx, {
            type: 'line',
            data: {
              labels: times,
              datasets: [{
                label: "Temperatur",
                data: temperatures,
                yAxisID: "temperature",
                borderColor: 'rgba(255, 0, 0, 1.0)',
                backgroundColor: 'rgba(0, 0, 0, 0.0)',
              }, {
                label: "PH-Wert",
                data: ph,
                yAxisID: "ph",
                borderColor: 'rgba(0, 0, 255, 1.0)',
                backgroundColor: 'rgba(0, 0, 0, 0.0)',
              }],
            },
            options: {
              responsive: false,
              scales: {
                yAxes: [{
                  id: "temperature",
                  display: true,
                  type: "linear",
                  position: "left",
                  ticks: {
                    beginAtZero: true,
                    max: 30,
                  },
                }, {
                  id: "ph",
                  display: true,
                  type: "linear",
                  position: "right",
                  ticks: {
                    beginAtZero: true,
                    max: 14,
                  },
                }],
              },
            },
          });
        });
      }
    </script>
  </body>

</html>